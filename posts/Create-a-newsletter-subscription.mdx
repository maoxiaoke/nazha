---
title: Create a Newsletter Subscription for Your Website
published: true
listed: true
date: '07/07/2022'
lastUpdateDate: '07/07/2022'
tags: technical,blog
language: Chinese
---

[â€œShare your workâ€](./10-principles-about-sharing-your-work) è¿™æœ¬ä¹¦ä¸­ä»‹ç» email ç›¸å¯¹äºç¤¾äº¤è´¦å·å’Œ RSSï¼Œä¼šæ›´ç´§å¯†åœ°å’Œä½ çš„ç”¨æˆ·ï¼ˆç²‰ä¸ï¼‰ä¿æŒè”ç³»ï¼Œå¹¶ä¸”æ›å…‰ç‡ä¹Ÿæ›´é«˜ï¼Œæ¯•ç«Ÿæ¯ä¸ªäººéƒ½æœ‰é‚®ç®±ã€‚

æ‰€ä»¥ï¼Œæœ¬æ–‡ä»‹ç»å¦‚ä½•ä½¿ç”¨ [Revue](https://www.getrevue.co/) è¿™ä¸ªæœåŠ¡æ¥ç»™ä½ çš„ä¸ªäººç½‘ç«™æ·»åŠ  Newsletter è®¢é˜…ã€‚

## Revue

[Revue](https://www.getrevue.co/app/issues) æ˜¯ä¸€ä¸ªæä¾› Newsletter çš„æœåŠ¡å¹³å°ï¼Œåœ¨ 2021 å¹´è¢« Twitter å…¬å¸æ”¶è´­ã€‚å¦‚æœå–œæ¬¢é€› Twitter çš„ç”¨æˆ·ï¼Œæœ‰æ—¶å€™å¯èƒ½å¯ä»¥çœ‹åˆ°æŸä¸ªç”¨æˆ·ä¸»é¡µä¼šå±•ç¤º Newsletter è®¢é˜…ï¼Œå…¶èƒŒåå°±æ˜¯ Revue æä¾›çš„æœåŠ¡ï¼Œæ¯”å¦‚[æˆ‘çš„ä¸»é¡µ](https://twitter.com/xiaokedada)ã€‚

![](https://nazha-image-store.oss-cn-shanghai.aliyuncs.com/blog/twitter-revue.png)

é™¤äº† Revue ä¹‹å¤–ï¼Œç±»ä¼¼çš„è¿˜æœ‰å…¶ä»–å¹³å°ï¼š

+ https://mailchimp.com/
+ https://substack.com/

## åˆ›å»º Revue è´¦å·

å¯ä»¥ç›´æ¥ä½¿ç”¨ Twitter è´¦å·æ³¨å†Œï¼Œæ³¨å†Œä¹‹åï¼Œç”±äºæˆ‘ä»¬éœ€è¦é›†æˆåˆ°è‡ªå·±çš„é¡µé¢ä¸Šï¼Œå› æ­¤éœ€è¦æ ¹æ®å…¶å¼€å‘çš„æ¥å£æ¥è¿›è¡Œå®šåˆ¶ã€‚æ¥å£çš„åœ°å€åœ¨ï¼šhttps://www.getrevue.co/apiã€‚

è°ƒç”¨æ¥å£éœ€è¦ç”³è¯·ã€‚æ­£å¸¸çš„æƒ…å†µä¸‹ï¼Œä½ åº”è¯¥åœ¨ https://www.getrevue.co/app/integrations è¿™ä¸ªé¡µé¢çš„åº•éƒ¨ç”³è¯·ã€‚ç”³è¯·é€šè¿‡åï¼Œä½ ä¼šå¾—åˆ°å¦‚ä¸‹çš„ä¸€ä¸² api_keyï¼š

![](https://nazha-image-store.oss-cn-shanghai.aliyuncs.com/blog/revue-api-key.png)

## å¤„ç† API KEY

åƒä¸‡ä¸è¦åœ¨å¼€æºå¹³å°[ä¸Šä¼ æ•æ„Ÿæ•°æ®](https://twitter.com/cz_binance/status/1543905416748359680?ref_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1543905416748359680%7Ctwgr%5E%7Ctwcon%5Es1_&ref_url=https%3A%2F%2Fwww.dw.com%2Fzh%2FE7B6B2E582B3E9BB91E5AEA2E7AB8AE8B3A3E4B8ADE59C8B10E58484E4BABAE5808BE8B387-E79BAEE5898DE5B7B2E79FA5E4BB80E9BABC%2Fa-62360819)ã€‚åœ¨ Next.js ä¸­ï¼Œä¸ºäº†æ»¡è¶³æœ¬åœ°æµ‹è¯•ï¼Œå¯ä»¥æ–°å»ºä¸€ä¸ª `.env.local` çš„[æœ¬åœ°ç¯å¢ƒå˜é‡æ–‡ä»¶](https://nextjs.org/docs/basic-features/environment-variables)ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ° `.gitignore` æ–‡ä»¶ä¸­ã€‚

```text
# .env.local
REVUE_API_KEY=3nahgxxxxxxxxxxxxxxxxxxxx
```

å¯¹äºç”Ÿäº§ç¯å¢ƒéœ€è¦ä½¿ç”¨ api_keyï¼Œå°±éœ€è¦åœ¨éƒ¨ç½²æˆ–è¿è¡Œæ—¶æ·»åŠ ç¯å¢ƒç¯å¢ƒå˜é‡ã€‚æ¯”å¦‚ä½¿ç”¨ [vercel](https://vercel.com) è¿›è¡Œå‘å¸ƒçš„æ—¶å€™ï¼Œå°±å¯ä»¥å¦‚ä¸‹é…ç½®ï¼š

![](https://nazha-image-store.oss-cn-shanghai.aliyuncs.com/blog/revue-api-key2.png)

## å¤„ç† Revue è¯·æ±‚
æ¥ä¸‹æ¥ï¼Œæ¥å®ç° Newsletter è®¢é˜…æœ€é‡è¦çš„[è¯·æ±‚](https://www.getrevue.co/api#post-/v2/subscribers)ã€‚æ ¹æ® Next.js æä¾›çš„ [API Routes](https://nextjs.org/docs/api-routes/introduction)ï¼Œå¯ä»¥å°†è¿™ä¸ªè¯·æ±‚å°è£…æˆä¸€ä¸ª api è·¯ç”±ï¼š

```ts
// pages/api/subscribe.ts
import type { NextApiRequest, NextApiResponse } from 'next';

export default async function handler(req: NextApiRequest, res: NextApiResponse) {
	const { email } = req.body;
    // å¤„ç†æœ¬åœ°è·¨åŸŸé—®é¢˜
	res.setHeader('Access-Control-Allow-Origin', '*');

	if (!email) {
		return res.status(400).json({
			error: 'Email is required'
		});
	}
	// https://www.getrevue.co/api#post-/v2/subscribers

	const revRes = await fetch('https://www.getrevue.co/api/v2/subscribers', {
		method: 'POST',
		headers: {
			Authorization: `Token ${process.env.REVUE_API_KEY}`,
			'Content-Type': 'application/json'
		},
		body: JSON.stringify({ email, double_opt_in: false })
	});

	const data = await revRes.json();

	if (!revRes.ok) {
		return res.status(500).json({
			error: data?.error?.email[0]
		});
	}
	return res.status(201).json({ error: '' });
}
```

## å®ç°ä¸€ä¸ª Subscribe ç»„ä»¶

æ¥ä¸‹æ¥ï¼Œä½¿ç”¨åŸç”Ÿçš„ `form` æ ‡ç­¾å®ç°ä¸€ä¸ª Subscrible ç»„ä»¶ã€‚å…·ä½“ä»£ç å¦‚ä¸‹ï¼š

```tsx
import React, { FormEvent, useRef, useState } from 'react';

const Subscribe = () => {
  const inputEl = useRef<HTMLInputElement>(null);
  const [errMsg, setErrMsg] = useState('');
  const [loading, setLoading] = useState(false);

  const subscribe = async (e: FormEvent) => {
    e.preventDefault();
    setLoading(true);

    const res = await fetch('/api/subscribe', {
      body: JSON.stringify({
        email: inputEl?.current?.value
      }),
      headers: {
        'Content-Type': 'application/json'
      },
      method: 'POST'
    });

    setLoading(false);
    const json = await res.json();
    const { error } = json;

    if (error) {
      setErrMsg(error);
      return;
    }

    if (inputEl?.current?.value) {
      inputEl.current.value = '';
    }

    setErrMsg('Success! ğŸ‰ You are now subscribed to the newsletter.');
  };

  return (
    <>
      <p>Subscribe to the newsletter</p>
      <p>
        Get emails from me about web development, tech, and early access to new articles. I will
        only send emails when new content is posted. No spam.
      </p>
      <form onSubmit={subscribe}>
        <input
          ref={inputEl}
          placeholder="Your e-mail address"
          type="email"
          autoComplete="email"
          required
        />
        {errMsg && <div>{errMsg}</div>}
        <button
          type="submit"
          {loading ? 'Loading': 'Subscribe'}
        </button>
      </form>
    </>
  );
};

export default Subscribe;
```

æœ€ç»ˆè·å¾—çš„æ•ˆæœå¦‚ä¸‹ï¼š

![](https://nazha-image-store.oss-cn-shanghai.aliyuncs.com/blog/subscribe-preview.png)

æ›´å¤šæ•ˆæœå¯è®¿é—®æˆ‘çš„ä¸ªäººç½‘ç«™ https://www.nazha.co/. åœ¨è¿™é‡Œï¼Œä½ å¯ä»¥æ‰¾åˆ°[æºç ](https://github.com/maoxiaoke/nazha)ã€‚
